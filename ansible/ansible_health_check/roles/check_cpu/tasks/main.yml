---
- name: Get CPU Information
  ansible.builtin.command: lscpu
  register: lscpu_output
  changed_when: false
  failed_when: false

- name: Create CPU Model result object
  ansible.builtin.set_fact:
    cpu_model_result:
      name: "CPU Model"
      command: "lscpu"
      result: "{{ lscpu_output.stdout | regex_search('Model name:\\s+(.+)', '\\1') | first | trim }}"
      status: "{{ lscpu_output.rc == 0 | ternary('PASS', 'FAIL') }}"
      notes: ""

- name: Append CPU Model result
  ansible.builtin.set_fact:
    test_results: "{{ test_results | combine({'cpu': test_results.cpu + [cpu_model_result]}, recursive=True) }}"

